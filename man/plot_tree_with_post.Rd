% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization.R
\name{plot_tree_with_post}
\alias{plot_tree_with_post}
\title{Plot a tree and the PGLMM posterior on phylogenetic effects}
\usage{
plot_tree_with_post(
  tree_file,
  meta_file,
  fit,
  covariates = c("age", "gender"),
  outcome = "crc",
  omit_na = FALSE,
  ladderize = TRUE,
  verbose = TRUE,
  labels,
  trim_pattern = NULL,
  return_tree_df = FALSE
)
}
\arguments{
\item{tree_file}{either a path to a tree file readable by \code{\link[ape:read.tree]{ape::read.tree()}} or an object of
class "phylo" that is already read into R. Ignored if \code{cor_mat} is supplied.}

\item{meta_file}{either a data frame of metadata or a path to file containing the metadata}

\item{fit}{a pglmm fit from \code{anpan_pglmm()}}

\item{covariates}{covariates to account for (as a vector of strings)}

\item{outcome}{the name of the outcome variable}

\item{omit_na}{logical indicating whether to omit incomplete cases of the metadata}

\item{ladderize}{logical indicating whether to run \code{\link[ape:ladderize]{ape::ladderize()}} on the tree before running the model}

\item{labels}{the ordered tip labels from the tree}

\item{trim_pattern}{optional pattern to trim from tip labels of the tree}

\item{return_tree_df}{if true, return a list containing 1) the plot, 2) the
segment data frame, and 3) the labelled terminal segment data frame.
Otherwise, just return the plot.}
}
\value{
either the plot or (if return_tree_df = TRUE) a list containing the plot, the segment df,
  the terminal segment df, and the yrep df.
}
\description{
Plot a tree and the PGLMM posterior on phylogenetic effects
}
\details{
The whiskers of each box plot are the 90% posterior intervals, the box is the 50%
  interval, and the middle line is the posterior mean.

  The \code{labels} needs to contain the leaf labels in the order produced by the Cholesky
  factorization of the correlation matrix (which is how the data are passed to the sampler). This
  is not necessarily the order of the leafs on the x-axis of the tree. The simplest way to get
  this is to take the \code{sample_id} column from the model_input result from anpan_pglmm().
}
